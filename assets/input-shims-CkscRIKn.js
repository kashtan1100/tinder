import{V as A,W as I,S as N,R as p,P,X as x,Y as R,Z as _}from"./index-3sg-s3AK.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const y=new WeakMap,g=(e,o,t,s=0,n=!1)=>{y.has(e)!==t&&(t?K(e,o,s,n):O(e,o))},M=e=>e===e.getRootNode().activeElement,K=(e,o,t,s=!1)=>{const n=o.parentNode,r=o.cloneNode(!1);r.classList.add("cloned-input"),r.tabIndex=-1,s&&(r.disabled=!0),n.appendChild(r),y.set(e,r);const c=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",o.style.transform="translate3d(".concat(c,"px,").concat(t,"px,0) scale(0)")},O=(e,o)=>{const t=y.get(e);t&&(y.delete(e),t.remove()),e.style.pointerEvents="",o.style.transform=""},F=(e,o,t)=>{if(!t||!o)return()=>{};const s=c=>{M(o)&&g(e,o,c)},n=()=>g(e,o,!1),r=()=>s(!0),i=()=>s(!1);return A(t,"ionScrollStart",r),A(t,"ionScrollEnd",i),o.addEventListener("blur",n),()=>{I(t,"ionScrollStart",r),I(t,"ionScrollEnd",i),o.removeEventListener("blur",n)}},b="input, textarea, [no-blur], [contenteditable]",k=()=>{let e=!0,o=!1;const t=document,s=()=>{o=!0},n=()=>{e=!0},r=i=>{if(o){o=!1;return}const c=t.activeElement;if(!c||c.matches(b))return;const d=i.target;d!==c&&(d.matches(b)||d.closest(b)||(e=!1,setTimeout(()=>{e||c.blur()},50)))};return A(t,"ionScrollStart",s),t.addEventListener("focusin",n,!0),t.addEventListener("touchend",r,!1),()=>{I(t,"ionScrollStart",s,!0),t.removeEventListener("focusin",n,!0),t.removeEventListener("touchend",r,!1)}},H=.3,Y=(e,o,t)=>{var s;const n=(s=e.closest("ion-item,[ion-item]"))!==null&&s!==void 0?s:e;return U(n.getBoundingClientRect(),o.getBoundingClientRect(),t,e.ownerDocument.defaultView.innerHeight)},U=(e,o,t,s)=>{const n=e.top,r=e.bottom,i=o.top,c=Math.min(o.bottom,s-t),d=i+15,u=c*.75-r,v=d-n,S=Math.round(u<0?-u:v>0?-v:0),m=Math.min(S,n-i),a=Math.abs(m)/H,f=Math.min(400,Math.max(150,a));return{scrollAmount:m,scrollDuration:f,scrollPadding:t,inputSafeY:-(n-d)+4}},W=(e,o,t,s,n,r=!1)=>{let i;const c=l=>{i=P(l)},d=l=>{if(!i)return;const u=P(l);!q(6,i,u)&&!M(o)&&$(e,o,t,s,n,r)};return e.addEventListener("touchstart",c,{capture:!0,passive:!0}),e.addEventListener("touchend",d,!0),()=>{e.removeEventListener("touchstart",c,!0),e.removeEventListener("touchend",d,!0)}},$=async(e,o,t,s,n,r=!1)=>{if(!t&&!s)return;const i=Y(e,t||s,n);if(t&&Math.abs(i.scrollAmount)<4){o.focus();return}if(g(e,o,!0,i.inputSafeY,r),o.focus(),x(()=>e.click()),typeof window<"u"){let c;const d=async()=>{c!==void 0&&clearTimeout(c),window.removeEventListener("ionKeyboardDidShow",l),window.removeEventListener("ionKeyboardDidShow",d),t&&await _(t,0,i.scrollAmount,i.scrollDuration),g(e,o,!1,i.inputSafeY),o.focus()},l=()=>{window.removeEventListener("ionKeyboardDidShow",l),window.addEventListener("ionKeyboardDidShow",d)};if(t){const u=await R(t),v=u.scrollHeight-u.clientHeight;if(i.scrollAmount>v-u.scrollTop){o.type==="password"?(i.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",l)):window.addEventListener("ionKeyboardDidShow",d),c=setTimeout(d,1e3);return}}d()}},q=(e,o,t)=>{if(o&&t){const s=o.x-t.x,n=o.y-t.y;return s*s+n*n>e*e}return!1},B="$ionPaddingTimer",G=e=>{const o=document,t=n=>{C(n.target,e)},s=n=>{C(n.target,0)};return o.addEventListener("focusin",t),o.addEventListener("focusout",s),()=>{o.removeEventListener("focusin",t),o.removeEventListener("focusout",s)}},C=(e,o)=>{var t,s;if(e.tagName!=="INPUT"||e.parentElement&&e.parentElement.tagName==="ION-INPUT"||((s=(t=e.parentElement)===null||t===void 0?void 0:t.parentElement)===null||s===void 0?void 0:s.tagName)==="ION-SEARCHBAR")return;const n=p(e);if(n===null)return;const r=n[B];r&&clearTimeout(r),o>0?n.style.setProperty("--keyboard-offset","".concat(o,"px")):n[B]=setTimeout(()=>{n.style.setProperty("--keyboard-offset","0px")},120)},V=!0,X=!0,z=(e,o)=>{const t=document,s=o==="ios",n=o==="android",r=e.getNumber("keyboardHeight",290),i=e.getBoolean("scrollAssist",!0),c=e.getBoolean("hideCaretOnScroll",s),d=e.getBoolean("inputBlurring",s),l=e.getBoolean("scrollPadding",!0),u=Array.from(t.querySelectorAll("ion-input, ion-textarea")),v=new WeakMap,S=new WeakMap,m=async a=>{await new Promise(L=>N(a,L));const f=a.shadowRoot||a,h=f.querySelector("input")||f.querySelector("textarea"),w=p(a),T=w?null:a.closest("ion-footer");if(!h)return;if(w&&c&&!v.has(a)){const L=F(a,h,w);v.set(a,L)}if(!(h.type==="date"||h.type==="datetime-local")&&(w||T)&&i&&!S.has(a)){const L=W(a,h,w,T,r,n);S.set(a,L)}},D=a=>{if(c){const f=v.get(a);f&&f(),v.delete(a)}if(i){const f=S.get(a);f&&f(),S.delete(a)}};d&&V&&k(),l&&X&&G(r);for(const a of u)m(a);t.addEventListener("ionInputDidLoad",a=>{m(a.detail)}),t.addEventListener("ionInputDidUnload",a=>{D(a.detail)})};export{z as startInputShims};
